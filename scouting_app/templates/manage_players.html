{% extends "base.html" %}
{% block title %}Gestionar jugadores{% endblock %}

{% block content %}
<h1 class="mb-4">Agregar jugadores</h1>
<p class="text-muted">Usa cualquiera de las opciones para sumar nuevos jugadores al sistema. Mas adelante se integrara la carga desde Excel. Solo se admiten jugadores de 12 a 18 a�os con un DNI identificatorio.</p>
<div class="alert alert-secondary py-2">
    Cupo operativo: <strong>{{ current_total }}</strong> / <strong>{{ max_players }}</strong> jugadores evaluables.
</div>

<div class="row g-4">
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">Carga individual</div>
            <div class="card-body">
                <form method="post">
  <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                    <input type="hidden" name="mode" value="single">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">Nombre</label>
                            <input type="text" name="name" class="form-control" required>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">DNI / ID</label>
                            <input type="text" name="national_id" class="form-control" inputmode="numeric" pattern="\d*" placeholder="Solo n�meros" required>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">Edad</label>
                            <input type="number" name="age" class="form-control" min="12" max="18" required>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">Posicion</label>
                            <select name="position" class="form-select" required>
                                {% for pos in position_options %}
                                <option value="{{ pos }}">{{ display_position(pos) }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Club</label>
                            <input type="text" name="club" class="form-control">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Pais</label>
                            <input type="text" name="country" class="form-control">
                        </div>
                        <div class="col-md-12">
                            <label class="form-label">Foto (URL opcional)</label>
                            <input type="url" name="photo_url" class="form-control"
                                   placeholder="https://... (si lo dejas vacio, se genera avatar aleatorio)">
                        </div>
                        {% for field, label in attribute_sequence %}
                        <div class="col-md-3">
                            <label class="form-label">{{ label }}</label>
                            <input type="number" name="{{ field }}" class="form-control" min="0" max="20" value="10">
                        </div>
                        {% endfor %}
                        <div class="col-12">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="potential_label_single" name="potential_label" value="1">
                                <label class="form-check-label" for="potential_label_single">
                                    Marcar como alto potencial
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="mt-4">
                        <button type="submit" class="btn btn-success">Guardar jugador</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header">Carga masiva (texto)</div>
            <div class="card-body">
                    <p class="text-muted small">
                    Pega una fila por jugador separando los campos con comas.<br>
                    Orden esperado: 17 columnas obligatorias + 1 opcional.<br>
                    (17) Nombre, DNI, Edad, Posicion, Club, Pais, Ritmo, Disparo, Pase, Regate, Defensa, Fisico, Vision, Marcaje, Determinacion, Tecnica, AltoPotencial (1/0).<br>
                    (18 opcional) FotoURL.
                    </p>
                    <form method="post">
  <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                        <input type="hidden" name="mode" value="bulk">
                    <textarea name="bulk_input" class="form-control" rows="12" placeholder="Ejemplo:
Juan Perez,40111222,15,Delantero,Club Local,Argentina,15,14,13,16,10,14,15,12,16,17,1
Luis Gomez,40888777,17,Mediocampista,Club B,Chile,13,11,15,14,12,13,14,13,15,14,0,https://picsum.photos/seed/luis-gomez/400/400"></textarea>
                    <div class="mt-3 d-flex justify-content-between">
                        <small class="text-muted">Se ignoraran lineas vacias y se informaran los errores por fila.</small>
                        <button type="submit" class="btn btn-outline-primary">Procesar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
